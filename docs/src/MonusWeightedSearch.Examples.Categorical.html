<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | </span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MonusWeightedSearch.Examples.Categorical</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Monus.html"><span class="hs-identifier">Data.Monus</span></a></span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-comment">-- import Control.Comonad.Trans.Cofree</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- import Control.Monad.Trans.Free</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(|||)</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Comonad</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nonEmpty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">type</span><span> </span><span id="%2B"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">type</span><span> </span><span id="%2A"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#%2A"><span class="hs-operator hs-var">(*)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">type</span><span> </span><span id="."><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#."><span class="hs-operator hs-var">(.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- newtype CofreeT f w a = CofreeT { runCofreeT :: w (a * f (CofreeT f w a)) }</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- newtype   FreeT f m a =   FreeT { runFreeT   :: m (a + f (  FreeT f w a)) }</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- type CoHeap w = CofreeT [] ((,) w)</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- type   Heap w =   FreeT ((,) w) []</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">newtype</span><span> </span><span id="CofreeF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-var">CofreeF</span></a></span></span><span> </span><span id="local-6989586621679091211"><span class="annot"><a href="#local-6989586621679091211"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679091210"><span class="annot"><a href="#local-6989586621679091210"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679091209"><span class="annot"><a href="#local-6989586621679091209"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CofreeF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-var">CofreeF</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runCofreeF"><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; Type) a (k :: k). CofreeF f a k -&gt; a * f k
</span><a href="MonusWeightedSearch.Examples.Categorical.html#runCofreeF"><span class="hs-identifier hs-var hs-var">runCofreeF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091210"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#%2A"><span class="hs-operator hs-type">*</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091211"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091209"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-26"></span><span class="hs-keyword">newtype</span><span>   </span><span id="FreeF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeF"><span class="hs-identifier hs-var">FreeF</span></a></span></span><span> </span><span id="local-6989586621679091201"><span class="annot"><a href="#local-6989586621679091201"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679091200"><span class="annot"><a href="#local-6989586621679091200"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679091199"><span class="annot"><a href="#local-6989586621679091199"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>   </span><span id="FreeF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeF"><span class="hs-identifier hs-var">FreeF</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runFreeF"><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; Type) a (k :: k). FreeF f a k -&gt; a + f k
</span><a href="MonusWeightedSearch.Examples.Categorical.html#runFreeF"><span class="hs-identifier hs-var hs-var">runFreeF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091200"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#%2B"><span class="hs-operator hs-type">+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091201"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091199"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">type</span><span> </span><span id="CofreeTF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeTF"><span class="hs-identifier hs-var">CofreeTF</span></a></span></span><span> </span><span id="local-6989586621679091015"><span class="annot"><a href="#local-6989586621679091015"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679091014"><span class="annot"><a href="#local-6989586621679091014"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679091013"><span class="annot"><a href="#local-6989586621679091013"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679091014"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-type">CofreeF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091015"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091013"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">type</span><span> </span><span id="CofreeT"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeT"><span class="hs-identifier hs-var">CofreeT</span></a></span></span><span>  </span><span id="local-6989586621679091012"><span class="annot"><a href="#local-6989586621679091012"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679091011"><span class="annot"><a href="#local-6989586621679091011"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679091010"><span class="annot"><a href="#local-6989586621679091010"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeTF"><span class="hs-identifier hs-type">CofreeTF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091012"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091011"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091010"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span id="local-6989586621679091189"><span id="local-6989586621679091190"><span id="local-6989586621679091191"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeT"><span class="hs-identifier hs-type">CofreeT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091190"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-type">CofreeF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091191"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091189"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeT"><span class="hs-identifier hs-type">CofreeT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091191"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091190"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeT"><span class="hs-identifier hs-type">CofreeT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091191"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091190"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091189"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bCofreeT"><span id="%24mCofreeT"><span id="CofreeT"><span class="annot"><span class="annottext">$bCofreeT :: forall (w :: Type -&gt; Type) (f :: Type -&gt; Type) a.
w (CofreeF f a (CofreeT f w a)) -&gt; CofreeT f w a
$mCofreeT :: forall {r} {w :: Type -&gt; Type} {f :: Type -&gt; Type} {a}.
CofreeT f w a
-&gt; (w (CofreeF f a (CofreeT f w a)) -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MonusWeightedSearch.Examples.Categorical.html#%24bCofreeT"><span class="hs-identifier hs-var hs-var hs-var">CofreeT</span></a></span></span></span></span><span> </span><span class="hs-special">{</span><span id="runCofreeT"><span class="annot"><span class="annottext">forall (w :: Type -&gt; Type) (f :: Type -&gt; Type) a.
CofreeT f w a -&gt; w (CofreeF f a (CofreeT f w a))
</span><a href="MonusWeightedSearch.Examples.Categorical.html#runCofreeT"><span class="hs-identifier hs-var hs-var hs-var">runCofreeT</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span id="local-6989586621679091006"><span class="annot"><a href="#local-6989586621679091006"><span class="hs-identifier hs-var">runCofreeT</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeT"><span class="hs-pragma hs-type">CofreeT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span id="local-6989586621679091167"><span id="local-6989586621679091168"><span id="local-6989586621679091169"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeT"><span class="hs-identifier hs-type">FreeT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091168"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeF"><span class="hs-identifier hs-type">FreeF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091169"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091167"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeT"><span class="hs-identifier hs-type">FreeT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091169"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091168"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091167"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeT"><span class="hs-identifier hs-type">FreeT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091169"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091168"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091167"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bFreeT"><span id="%24mFreeT"><span id="FreeT"><span class="annot"><span class="annottext">$bFreeT :: forall (m :: Type -&gt; Type) (f :: Type -&gt; Type) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
$mFreeT :: forall {r} {m :: Type -&gt; Type} {f :: Type -&gt; Type} {a}.
FreeT f m a
-&gt; (m (FreeF f a (FreeT f m a)) -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MonusWeightedSearch.Examples.Categorical.html#%24bFreeT"><span class="hs-identifier hs-var hs-var hs-var">FreeT</span></a></span></span></span></span><span> </span><span class="hs-special">{</span><span id="runFreeT"><span class="annot"><span class="annottext">forall (m :: Type -&gt; Type) (f :: Type -&gt; Type) a.
FreeT f m a -&gt; m (FreeF f a (FreeT f m a))
</span><a href="MonusWeightedSearch.Examples.Categorical.html#runFreeT"><span class="hs-identifier hs-var hs-var hs-var">runFreeT</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span id="local-6989586621679090999"><span class="annot"><a href="#local-6989586621679090999"><span class="hs-identifier hs-var">runFreeT</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeT"><span class="hs-pragma hs-type">FreeT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">type</span><span> </span><span id="FreeTF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeTF"><span class="hs-identifier hs-var">FreeTF</span></a></span></span><span> </span><span id="local-6989586621679090996"><span class="annot"><a href="#local-6989586621679090996"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679090995"><span class="annot"><a href="#local-6989586621679090995"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679090994"><span class="annot"><a href="#local-6989586621679090994"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679090995"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeF"><span class="hs-identifier hs-type">FreeF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090996"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090994"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">type</span><span> </span><span id="FreeT"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeT"><span class="hs-identifier hs-var">FreeT</span></a></span></span><span>  </span><span id="local-6989586621679090993"><span class="annot"><a href="#local-6989586621679090993"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679090992"><span class="annot"><a href="#local-6989586621679090992"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679090991"><span class="annot"><a href="#local-6989586621679090991"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeTF"><span class="hs-identifier hs-type">FreeTF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090993"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090992"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090991"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">type</span><span> </span><span id="CoHeapF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeapF"><span class="hs-identifier hs-var">CoHeapF</span></a></span></span><span> </span><span id="local-6989586621679090990"><span class="annot"><a href="#local-6989586621679090990"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679090989"><span class="annot"><a href="#local-6989586621679090989"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeTF"><span class="hs-identifier hs-type">CofreeTF</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679090990"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679090989"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">type</span><span>   </span><span id="HeapF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#HeapF"><span class="hs-identifier hs-var">HeapF</span></a></span></span><span> </span><span id="local-6989586621679090987"><span class="annot"><a href="#local-6989586621679090987"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679090986"><span class="annot"><a href="#local-6989586621679090986"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeTF"><span class="hs-identifier hs-type">FreeTF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679090987"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679090986"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">type</span><span> </span><span id="CoHeap"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-var">CoHeap</span></a></span></span><span> </span><span id="local-6989586621679090985"><span class="annot"><a href="#local-6989586621679090985"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679090984"><span class="annot"><a href="#local-6989586621679090984"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeT"><span class="hs-identifier hs-type">CofreeT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679090985"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679090984"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">type</span><span>   </span><span id="Heap"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Heap"><span class="hs-identifier hs-var">Heap</span></a></span></span><span> </span><span id="local-6989586621679090982"><span class="annot"><a href="#local-6989586621679090982"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679090981"><span class="annot"><a href="#local-6989586621679090981"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeT"><span class="hs-identifier hs-type">FreeT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679090982"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679090981"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span id="local-6989586621679091154"><span id="local-6989586621679091155"><span id="local-6989586621679091156"><span id="local-6989586621679091158"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#traceT"><span class="hs-identifier hs-type">traceT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679091158"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679091156"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091158"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091155"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091154"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091158"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091155"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091156"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091158"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091155"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091158"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091155"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeT"><span class="hs-identifier hs-type">CofreeT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091156"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091158"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091154"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-50"></span><span id="traceT"><span class="annot"><span class="annottext">traceT :: forall (w :: Type -&gt; Type) (f :: Type -&gt; Type) a b.
(Comonad w, Functor f) =&gt;
(w a -&gt; b) -&gt; (w a -&gt; f (w a)) -&gt; w a -&gt; CofreeT f w b
</span><a href="MonusWeightedSearch.Examples.Categorical.html#traceT"><span class="hs-identifier hs-var hs-var">traceT</span></a></span></span><span> </span><span id="local-6989586621679090971"><span class="annot"><span class="annottext">w a -&gt; b
</span><a href="#local-6989586621679090971"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679090970"><span class="annot"><span class="annottext">w a -&gt; f (w a)
</span><a href="#local-6989586621679090970"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679090969"><span class="annot"><span class="annottext">w a
</span><a href="#local-6989586621679090969"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">w (CofreeF f b (CofreeT f w b)) -&gt; CofreeT f w b
forall (w :: Type -&gt; Type) (f :: Type -&gt; Type) a.
w (CofreeF f a (CofreeT f w a)) -&gt; CofreeT f w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeT"><span class="hs-identifier hs-var">CofreeT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b * f (CofreeT f w b)) -&gt; CofreeF f b (CofreeT f w b)
forall {k} (f :: k -&gt; Type) a (k :: k). (a * f k) -&gt; CofreeF f a k
</span><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-var">CofreeF</span></a></span><span> </span><span class="annot"><span class="annottext">((b * f (CofreeT f w b)) -&gt; CofreeF f b (CofreeT f w b))
-&gt; (w a -&gt; b * f (CofreeT f w b))
-&gt; w a
-&gt; CofreeF f b (CofreeT f w b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w a -&gt; b
</span><a href="#local-6989586621679090971"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(w a -&gt; b)
-&gt; (w a -&gt; f (CofreeT f w b)) -&gt; w a -&gt; b * f (CofreeT f w b)
forall (a :: Type -&gt; Type -&gt; Type) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(w a -&gt; CofreeT f w b) -&gt; f (w a) -&gt; f (CofreeT f w b)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(w a -&gt; b) -&gt; (w a -&gt; f (w a)) -&gt; w a -&gt; CofreeT f w b
forall (w :: Type -&gt; Type) (f :: Type -&gt; Type) a b.
(Comonad w, Functor f) =&gt;
(w a -&gt; b) -&gt; (w a -&gt; f (w a)) -&gt; w a -&gt; CofreeT f w b
</span><a href="MonusWeightedSearch.Examples.Categorical.html#traceT"><span class="hs-identifier hs-var">traceT</span></a></span><span> </span><span class="annot"><span class="annottext">w a -&gt; b
</span><a href="#local-6989586621679090971"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">w a -&gt; f (w a)
</span><a href="#local-6989586621679090970"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f (w a) -&gt; f (CofreeT f w b))
-&gt; (w a -&gt; f (w a)) -&gt; w a -&gt; f (CofreeT f w b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">w a -&gt; f (w a)
</span><a href="#local-6989586621679090970"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(w a -&gt; CofreeF f b (CofreeT f w b))
-&gt; w a -&gt; w (CofreeF f b (CofreeT f w b))
forall (w :: Type -&gt; Type) a b.
Comonad w =&gt;
(w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-operator hs-var">&lt;&lt;=</span></span><span> </span><span class="annot"><span class="annottext">w a
</span><a href="#local-6989586621679090969"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span id="local-6989586621679091132"><span id="local-6989586621679091133"><span id="local-6989586621679091134"><span id="local-6989586621679091135"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#evalT"><span class="hs-identifier hs-type">evalT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679091135"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679091134"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091133"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091132"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091135"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091132"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091132"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#FreeT"><span class="hs-identifier hs-type">FreeT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091135"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091133"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091132"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-53"></span><span id="evalT"><span class="annot"><span class="annottext">evalT :: forall (f :: Type -&gt; Type) (m :: Type -&gt; Type) a b.
(Functor f, Monad m) =&gt;
(a -&gt; m b) -&gt; (f (m b) -&gt; m b) -&gt; FreeT f m a -&gt; m b
</span><a href="MonusWeightedSearch.Examples.Categorical.html#evalT"><span class="hs-identifier hs-var hs-var">evalT</span></a></span></span><span> </span><span id="local-6989586621679090959"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679090959"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679090958"><span class="annot"><span class="annottext">f (m b) -&gt; m b
</span><a href="#local-6989586621679090958"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; m b)
-&gt; (f (FreeT f m a) -&gt; m b) -&gt; Either a (f (FreeT f m a)) -&gt; m b
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679090959"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (m b) -&gt; m b
</span><a href="#local-6989586621679090958"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(f (m b) -&gt; m b)
-&gt; (f (FreeT f m a) -&gt; f (m b)) -&gt; f (FreeT f m a) -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FreeT f m a -&gt; m b) -&gt; f (FreeT f m a) -&gt; f (m b)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; m b) -&gt; (f (m b) -&gt; m b) -&gt; FreeT f m a -&gt; m b
forall (f :: Type -&gt; Type) (m :: Type -&gt; Type) a b.
(Functor f, Monad m) =&gt;
(a -&gt; m b) -&gt; (f (m b) -&gt; m b) -&gt; FreeT f m a -&gt; m b
</span><a href="MonusWeightedSearch.Examples.Categorical.html#evalT"><span class="hs-identifier hs-var">evalT</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679090959"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f (m b) -&gt; m b
</span><a href="#local-6989586621679090958"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either a (f (FreeT f m a)) -&gt; m b)
-&gt; (FreeF f a (FreeT f m a) -&gt; Either a (f (FreeT f m a)))
-&gt; FreeF f a (FreeT f m a)
-&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FreeF f a (FreeT f m a) -&gt; Either a (f (FreeT f m a))
forall {k} (f :: k -&gt; Type) a (k :: k). FreeF f a k -&gt; a + f k
</span><a href="MonusWeightedSearch.Examples.Categorical.html#runFreeF"><span class="hs-identifier hs-var hs-var">runFreeF</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FreeF f a (FreeT f m a) -&gt; m b)
-&gt; (FreeT f m a -&gt; m (FreeF f a (FreeT f m a)))
-&gt; FreeT f m a
-&gt; m b
forall (m :: Type -&gt; Type) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">FreeT f m a -&gt; m (FreeF f a (FreeT f m a))
forall (m :: Type -&gt; Type) (f :: Type -&gt; Type) a.
FreeT f m a -&gt; m (FreeF f a (FreeT f m a))
</span><a href="MonusWeightedSearch.Examples.Categorical.html#runFreeT"><span class="hs-identifier hs-var">runFreeT</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621679091118"><span id="local-6989586621679091119"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091119"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091118"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091119"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091118"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091119"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091118"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bRoot"><span id="%24mRoot"><span id="Root"><span class="annot"><span class="annottext">$bRoot :: forall w a. w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
$mRoot :: forall {r} {w} {a}.
CoHeap w a -&gt; (w -&gt; a -&gt; [CoHeap w a] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MonusWeightedSearch.Examples.Categorical.html#%24bRoot"><span class="hs-identifier hs-var hs-var hs-var">Root</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679090952"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090951"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090950"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679090952"><span class="annot"><a href="#local-6989586621679090952"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-type">CofreeF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679090951"><span class="annot"><a href="#local-6989586621679090951"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679090950"><span class="annot"><a href="#local-6989586621679090950"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-pragma hs-type">Root</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span id="local-6989586621679091111"><span id="local-6989586621679091112"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#RootF"><span class="hs-identifier hs-type">RootF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091112"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091111"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091112"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091111"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeapF"><span class="hs-identifier hs-type">CoHeapF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091112"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091111"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091112"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091111"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bRootF"><span id="%24mRootF"><span id="RootF"><span class="annot"><span class="annottext">$bRootF :: forall w a. w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeapF w a (CoHeap w a)
$mRootF :: forall {r} {w} {a}.
CoHeapF w a (CoHeap w a)
-&gt; (w -&gt; a -&gt; [CoHeap w a] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MonusWeightedSearch.Examples.Categorical.html#%24bRootF"><span class="hs-identifier hs-var hs-var hs-var">RootF</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679090946"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090945"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090944"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679090946"><span class="annot"><a href="#local-6989586621679090946"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-type">CofreeF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679090945"><span class="annot"><a href="#local-6989586621679090945"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679090944"><span class="annot"><a href="#local-6989586621679090944"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#RootF"><span class="hs-pragma hs-type">RootF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">newtype</span><span> </span><span id="Fix"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-var">Fix</span></a></span></span><span> </span><span id="local-6989586621679091177"><span class="annot"><a href="#local-6989586621679091177"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Fix"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-var">Fix</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unFix"><span class="annot"><span class="annottext">forall (f :: Type -&gt; Type). Fix f -&gt; f (Fix f)
</span><a href="MonusWeightedSearch.Examples.Categorical.html#unFix"><span class="hs-identifier hs-var hs-var">unFix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091177"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091177"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621679091104"><span id="local-6989586621679091105"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#apo"><span class="hs-identifier hs-type">apo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679091105"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091104"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091105"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091105"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#%2B"><span class="hs-operator hs-type">+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091104"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091104"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091105"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-66"></span><span id="apo"><span class="annot"><span class="annottext">apo :: forall (f :: Type -&gt; Type) a.
Functor f =&gt;
(a -&gt; f (Fix f + a)) -&gt; a -&gt; Fix f
</span><a href="MonusWeightedSearch.Examples.Categorical.html#apo"><span class="hs-identifier hs-var hs-var">apo</span></a></span></span><span> </span><span id="local-6989586621679090936"><span class="annot"><span class="annottext">a -&gt; f (Fix f + a)
</span><a href="#local-6989586621679090936"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Fix f) -&gt; Fix f
forall (f :: Type -&gt; Type). f (Fix f) -&gt; Fix f
</span><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-var">Fix</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Fix f) -&gt; Fix f) -&gt; (a -&gt; f (Fix f)) -&gt; a -&gt; Fix f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Fix f + a) -&gt; Fix f) -&gt; f (Fix f + a) -&gt; f (Fix f)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fix f -&gt; Fix f
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Fix f -&gt; Fix f) -&gt; (a -&gt; Fix f) -&gt; (Fix f + a) -&gt; Fix f
forall (a :: Type -&gt; Type -&gt; Type) b d c.
ArrowChoice a =&gt;
a b d -&gt; a c d -&gt; a (Either b c) d
</span><span class="hs-operator hs-var">|||</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f (Fix f + a)) -&gt; a -&gt; Fix f
forall (f :: Type -&gt; Type) a.
Functor f =&gt;
(a -&gt; f (Fix f + a)) -&gt; a -&gt; Fix f
</span><a href="MonusWeightedSearch.Examples.Categorical.html#apo"><span class="hs-identifier hs-var">apo</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; f (Fix f + a)
</span><a href="#local-6989586621679090936"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f (Fix f + a) -&gt; f (Fix f))
-&gt; (a -&gt; f (Fix f + a)) -&gt; a -&gt; f (Fix f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f (Fix f + a)
</span><a href="#local-6989586621679090936"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span id="local-6989586621679091094"><span id="local-6989586621679091095"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#cata"><span class="hs-identifier hs-type">cata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679091095"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091095"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091094"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091094"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091095"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091094"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-69"></span><span id="cata"><span class="annot"><span class="annottext">cata :: forall (f :: Type -&gt; Type) a. Functor f =&gt; (f a -&gt; a) -&gt; Fix f -&gt; a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#cata"><span class="hs-identifier hs-var hs-var">cata</span></a></span></span><span> </span><span id="local-6989586621679090930"><span class="annot"><span class="annottext">f a -&gt; a
</span><a href="#local-6989586621679090930"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; a
</span><a href="#local-6989586621679090930"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(f a -&gt; a) -&gt; (Fix f -&gt; f a) -&gt; Fix f -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Fix f -&gt; a) -&gt; f (Fix f) -&gt; f a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; a) -&gt; Fix f -&gt; a
forall (f :: Type -&gt; Type) a. Functor f =&gt; (f a -&gt; a) -&gt; Fix f -&gt; a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#cata"><span class="hs-identifier hs-var">cata</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; a
</span><a href="#local-6989586621679090930"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f (Fix f) -&gt; f a) -&gt; (Fix f -&gt; f (Fix f)) -&gt; Fix f -&gt; f a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Fix f -&gt; f (Fix f)
forall (f :: Type -&gt; Type). Fix f -&gt; f (Fix f)
</span><a href="MonusWeightedSearch.Examples.Categorical.html#unFix"><span class="hs-identifier hs-var hs-var">unFix</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="local-6989586621679091090"><span id="local-6989586621679091091"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#para"><span class="hs-identifier hs-type">para</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679091091"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091091"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091091"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#%2A"><span class="hs-operator hs-type">*</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091091"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091090"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-72"></span><span id="para"><span class="annot"><span class="annottext">para :: forall (f :: Type -&gt; Type) a.
Functor f =&gt;
(f (Fix f * a) -&gt; a) -&gt; Fix f -&gt; a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#para"><span class="hs-identifier hs-var hs-var">para</span></a></span></span><span> </span><span id="local-6989586621679090924"><span class="annot"><span class="annottext">f (Fix f * a) -&gt; a
</span><a href="#local-6989586621679090924"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Fix f * a) -&gt; a
</span><a href="#local-6989586621679090924"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Fix f * a) -&gt; a) -&gt; (Fix f -&gt; f (Fix f * a)) -&gt; Fix f -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Fix f -&gt; Fix f * a) -&gt; f (Fix f) -&gt; f (Fix f * a)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fix f -&gt; Fix f
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Fix f -&gt; Fix f) -&gt; (Fix f -&gt; a) -&gt; Fix f -&gt; Fix f * a
forall (a :: Type -&gt; Type -&gt; Type) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(f (Fix f * a) -&gt; a) -&gt; Fix f -&gt; a
forall (f :: Type -&gt; Type) a.
Functor f =&gt;
(f (Fix f * a) -&gt; a) -&gt; Fix f -&gt; a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#para"><span class="hs-identifier hs-var">para</span></a></span><span> </span><span class="annot"><span class="annottext">f (Fix f * a) -&gt; a
</span><a href="#local-6989586621679090924"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f (Fix f) -&gt; f (Fix f * a))
-&gt; (Fix f -&gt; f (Fix f)) -&gt; Fix f -&gt; f (Fix f * a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Fix f -&gt; f (Fix f)
forall (f :: Type -&gt; Type). Fix f -&gt; f (Fix f)
</span><a href="MonusWeightedSearch.Examples.Categorical.html#unFix"><span class="hs-identifier hs-var hs-var">unFix</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621679091086"><span id="local-6989586621679091087"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#ana"><span class="hs-identifier hs-type">ana</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679091087"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091086"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091087"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091086"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091087"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-75"></span><span id="ana"><span class="annot"><span class="annottext">ana :: forall (f :: Type -&gt; Type) a. Functor f =&gt; (a -&gt; f a) -&gt; a -&gt; Fix f
</span><a href="MonusWeightedSearch.Examples.Categorical.html#ana"><span class="hs-identifier hs-var hs-var">ana</span></a></span></span><span> </span><span id="local-6989586621679090919"><span class="annot"><span class="annottext">a -&gt; f a
</span><a href="#local-6989586621679090919"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Fix f) -&gt; Fix f
forall (f :: Type -&gt; Type). f (Fix f) -&gt; Fix f
</span><a href="MonusWeightedSearch.Examples.Categorical.html#Fix"><span class="hs-identifier hs-var">Fix</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Fix f) -&gt; Fix f) -&gt; (a -&gt; f (Fix f)) -&gt; a -&gt; Fix f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Fix f) -&gt; f a -&gt; f (Fix f)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; f a) -&gt; a -&gt; Fix f
forall (f :: Type -&gt; Type) a. Functor f =&gt; (a -&gt; f a) -&gt; a -&gt; Fix f
</span><a href="MonusWeightedSearch.Examples.Categorical.html#ana"><span class="hs-identifier hs-var">ana</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
</span><a href="#local-6989586621679090919"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f a -&gt; f (Fix f)) -&gt; (a -&gt; f a) -&gt; a -&gt; f (Fix f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
</span><a href="#local-6989586621679090919"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">type</span><span> </span><span id="NEListF"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#NEListF"><span class="hs-identifier hs-var">NEListF</span></a></span></span><span> </span><span id="local-6989586621679090918"><span class="annot"><a href="#local-6989586621679090918"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679090917"><span class="annot"><a href="#local-6989586621679090917"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679090918"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-type">CofreeF</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679090917"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">type</span><span> </span><span id="Pairing"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Pairing"><span class="hs-identifier hs-var">Pairing</span></a></span></span><span> </span><span id="local-6989586621679090916"><span class="annot"><a href="#local-6989586621679090916"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679090915"><span class="annot"><a href="#local-6989586621679090915"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090916"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090915"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090916"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679090915"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span id="local-6989586621679091081"><span id="local-6989586621679091083"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#pcons"><span class="hs-identifier hs-type">pcons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Monus.html#Monus"><span class="hs-identifier hs-type">Monus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091083"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091083"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Pairing"><span class="hs-identifier hs-type">Pairing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091083"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Pairing"><span class="hs-identifier hs-type">Pairing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091083"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091081"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-82"></span><span id="pcons"><span class="annot"><span class="annottext">pcons :: forall w a. Monus w =&gt; CoHeap w a -&gt; Pairing w a -&gt; Pairing w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#pcons"><span class="hs-identifier hs-var hs-var">pcons</span></a></span></span><span> </span><span id="local-6989586621679090909"><span class="annot"><span class="annottext">CoHeap w a
</span><a href="#local-6989586621679090909"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span id="local-6989586621679090908"><span class="annot"><span class="annottext">Pairing w a
</span><a href="#local-6989586621679090908"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (CoHeap w a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pairing w a
</span><a href="#local-6989586621679090908"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoHeap w a -&gt; Maybe (CoHeap w a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CoHeap w a
</span><a href="#local-6989586621679090909"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#pcons"><span class="hs-identifier hs-var">pcons</span></a></span><span> </span><span id="local-6989586621679090907"><span class="annot"><span class="annottext">CoHeap w a
</span><a href="#local-6989586621679090907"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679090906"><span class="annot"><span class="annottext">Pairing w a
</span><a href="#local-6989586621679090906"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679090905"><span class="annot"><span class="annottext">CoHeap w a
</span><a href="#local-6989586621679090905"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; Maybe (CoHeap w a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoHeap w a
-&gt; (CoHeap w a -&gt; CoHeap w a) -&gt; Maybe (CoHeap w a) -&gt; CoHeap w a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoHeap w a
</span><a href="#local-6989586621679090905"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; CoHeap w a -&gt; CoHeap w a
forall w a. Monus w =&gt; CoHeap w a -&gt; CoHeap w a -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoHeap w a
</span><a href="#local-6989586621679090907"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoHeap w a
</span><a href="#local-6989586621679090905"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; CoHeap w a -&gt; CoHeap w a
forall w a. Monus w =&gt; CoHeap w a -&gt; CoHeap w a -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoHeap w a
</span><a href="#local-6989586621679090907"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; CoHeap w a -&gt; CoHeap w a
forall w a. Monus w =&gt; CoHeap w a -&gt; CoHeap w a -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pairing w a
</span><a href="#local-6989586621679090906"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (CoHeap w a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679091072"><span id="local-6989586621679091073"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#pnil"><span class="hs-identifier hs-type">pnil</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Pairing"><span class="hs-identifier hs-type">Pairing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091073"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091072"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-86"></span><span id="pnil"><span class="annot"><span class="annottext">pnil :: forall w a. Pairing w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#pnil"><span class="hs-identifier hs-var hs-var">pnil</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CoHeap w a) -&gt; Maybe (CoHeap w a)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621679091068"><span id="local-6989586621679091069"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#prun"><span class="hs-identifier hs-type">prun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Pairing"><span class="hs-identifier hs-type">Pairing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091069"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091068"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091069"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091068"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-89"></span><span id="prun"><span class="annot"><span class="annottext">prun :: forall w a. Pairing w a -&gt; Maybe (CoHeap w a)
</span><a href="MonusWeightedSearch.Examples.Categorical.html#prun"><span class="hs-identifier hs-var hs-var">prun</span></a></span></span><span> </span><span id="local-6989586621679090900"><span class="annot"><span class="annottext">Pairing w a
</span><a href="#local-6989586621679090900"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pairing w a
</span><a href="#local-6989586621679090900"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (CoHeap w a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span id="local-6989586621679091064"><span id="local-6989586621679091065"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#popMin"><span class="hs-identifier hs-type">popMin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Monus.html#Monus"><span class="hs-identifier hs-type">Monus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091065"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091065"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091064"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#NEListF"><span class="hs-identifier hs-type">NEListF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091065"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091064"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091065"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091064"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-92"></span><span id="popMin"><span class="annot"><span class="annottext">popMin :: forall w a. Monus w =&gt; CoHeap w a -&gt; NEListF w a (CoHeap w a)
</span><a href="MonusWeightedSearch.Examples.Categorical.html#popMin"><span class="hs-identifier hs-var hs-var">popMin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w, CofreeF Maybe a (CoHeap w a))
-&gt; Compose ((,) w) (CofreeF Maybe a) (CoHeap w a)
forall {k} {k1} (f :: k -&gt; Type) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">((w, CofreeF Maybe a (CoHeap w a))
 -&gt; Compose ((,) w) (CofreeF Maybe a) (CoHeap w a))
-&gt; (CoHeap w a -&gt; (w, CofreeF Maybe a (CoHeap w a)))
-&gt; CoHeap w a
-&gt; Compose ((,) w) (CofreeF Maybe a) (CoHeap w a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CofreeF [] a (CoHeap w a) -&gt; CofreeF Maybe a (CoHeap w a))
-&gt; (w, CofreeF [] a (CoHeap w a))
-&gt; (w, CofreeF Maybe a (CoHeap w a))
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a * Maybe (CoHeap w a)) -&gt; CofreeF Maybe a (CoHeap w a)
forall {k} (f :: k -&gt; Type) a (k :: k). (a * f k) -&gt; CofreeF f a k
</span><a href="MonusWeightedSearch.Examples.Categorical.html#CofreeF"><span class="hs-identifier hs-var">CofreeF</span></a></span><span> </span><span class="annot"><span class="annottext">((a * Maybe (CoHeap w a)) -&gt; CofreeF Maybe a (CoHeap w a))
-&gt; (CofreeF [] a (CoHeap w a) -&gt; a * Maybe (CoHeap w a))
-&gt; CofreeF [] a (CoHeap w a)
-&gt; CofreeF Maybe a (CoHeap w a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([CoHeap w a] -&gt; Maybe (CoHeap w a))
-&gt; (a, [CoHeap w a]) -&gt; a * Maybe (CoHeap w a)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pairing w a -&gt; Maybe (CoHeap w a)
forall w a. Pairing w a -&gt; Maybe (CoHeap w a)
</span><a href="MonusWeightedSearch.Examples.Categorical.html#prun"><span class="hs-identifier hs-var">prun</span></a></span><span> </span><span class="annot"><span class="annottext">(Pairing w a -&gt; Maybe (CoHeap w a))
-&gt; ([CoHeap w a] -&gt; Pairing w a)
-&gt; [CoHeap w a]
-&gt; Maybe (CoHeap w a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CoHeap w a -&gt; Pairing w a -&gt; Pairing w a)
-&gt; Pairing w a -&gt; [CoHeap w a] -&gt; Pairing w a
forall (t :: Type -&gt; Type) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; Pairing w a -&gt; Pairing w a
forall w a. Monus w =&gt; CoHeap w a -&gt; Pairing w a -&gt; Pairing w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#pcons"><span class="hs-identifier hs-var">pcons</span></a></span><span> </span><span class="annot"><span class="annottext">Pairing w a
forall w a. Pairing w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#pnil"><span class="hs-identifier hs-var">pnil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a, [CoHeap w a]) -&gt; a * Maybe (CoHeap w a))
-&gt; (CofreeF [] a (CoHeap w a) -&gt; (a, [CoHeap w a]))
-&gt; CofreeF [] a (CoHeap w a)
-&gt; a * Maybe (CoHeap w a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CofreeF [] a (CoHeap w a) -&gt; (a, [CoHeap w a])
forall {k} (f :: k -&gt; Type) a (k :: k). CofreeF f a k -&gt; a * f k
</span><a href="MonusWeightedSearch.Examples.Categorical.html#runCofreeF"><span class="hs-identifier hs-var hs-var">runCofreeF</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((w, CofreeF [] a (CoHeap w a))
 -&gt; (w, CofreeF Maybe a (CoHeap w a)))
-&gt; (CoHeap w a -&gt; (w, CofreeF [] a (CoHeap w a)))
-&gt; CoHeap w a
-&gt; (w, CofreeF Maybe a (CoHeap w a))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Compose ((,) w) (CofreeF [] a) (CoHeap w a)
-&gt; (w, CofreeF [] a (CoHeap w a))
forall {k1} {k2} (f :: k1 -&gt; Type) (g :: k2 -&gt; k1) (a :: k2).
Compose f g a -&gt; f (g a)
</span><span class="hs-identifier hs-var hs-var">getCompose</span></span><span> </span><span class="annot"><span class="annottext">(Compose ((,) w) (CofreeF [] a) (CoHeap w a)
 -&gt; (w, CofreeF [] a (CoHeap w a)))
-&gt; (CoHeap w a -&gt; Compose ((,) w) (CofreeF [] a) (CoHeap w a))
-&gt; CoHeap w a
-&gt; (w, CofreeF [] a (CoHeap w a))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; Compose ((,) w) (CofreeF [] a) (CoHeap w a)
forall (f :: Type -&gt; Type). Fix f -&gt; f (Fix f)
</span><a href="MonusWeightedSearch.Examples.Categorical.html#unFix"><span class="hs-identifier hs-var hs-var">unFix</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="local-6989586621679091074"><span id="local-6989586621679091075"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#%3C%2B%3E"><span class="hs-operator hs-type">(&lt;+&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Monus.html#Monus"><span class="hs-identifier hs-type">Monus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091075"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091075"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091074"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091075"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091074"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091075"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091074"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-95"></span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span id="local-6989586621679090883"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090883"><span class="hs-identifier hs-var">xw</span></a></span></span><span> </span><span id="local-6989586621679090882"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090882"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679090881"><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090881"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="%3C%2B%3E"><span class="annot"><span class="annottext">&lt;+&gt; :: forall w a. Monus w =&gt; CoHeap w a -&gt; CoHeap w a -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#%3C%2B%3E"><span class="hs-operator hs-var hs-var">&lt;+&gt;</span></a></span></span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span id="local-6989586621679090880"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090880"><span class="hs-identifier hs-var">yw</span></a></span></span><span> </span><span id="local-6989586621679090879"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090879"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679090878"><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090878"><span class="hs-identifier hs-var">ys</span></a></span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090883"><span class="hs-identifier hs-var">xw</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090880"><span class="hs-identifier hs-var">yw</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
forall w a. w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-var">Root</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090883"><span class="hs-identifier hs-var">xw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090882"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
forall w a. w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-var">Root</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090880"><span class="hs-identifier hs-var">yw</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Monus a =&gt; a -&gt; a -&gt; a
</span><a href="Data.Monus.html#%7C-%7C"><span class="hs-operator hs-var">|-|</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090883"><span class="hs-identifier hs-var">xw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090879"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090878"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; [CoHeap w a] -&gt; [CoHeap w a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090881"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
forall w a. w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-var">Root</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090880"><span class="hs-identifier hs-var">yw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090879"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
forall w a. w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-var">Root</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090883"><span class="hs-identifier hs-var">xw</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Monus a =&gt; a -&gt; a -&gt; a
</span><a href="Data.Monus.html#%7C-%7C"><span class="hs-operator hs-var">|-|</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090880"><span class="hs-identifier hs-var">yw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090882"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090881"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; [CoHeap w a] -&gt; [CoHeap w a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090878"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- Action   :: m -&gt; a -&gt; a</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- coaction :: a -&gt; (m, a)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | A class for things that can be decomposed in a coassiciative way.</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- split x == (y :| []) ==&gt; x == y</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- all unital (unfoldr split x) where unital x = snd x == Nothing</span><span>
</span><span id="line-107"></span><span>    </span><span>
</span><span id="line-108"></span><span class="hs-keyword">class</span><span> </span><span id="Comonoid"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Comonoid"><span class="hs-identifier hs-var">Comonoid</span></a></span></span><span> </span><span id="local-6989586621679091044"><span class="annot"><a href="#local-6989586621679091044"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="split"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#split"><span class="hs-identifier hs-type">split</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091044"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679091044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span>
</span><span id="line-111"></span><span class="hs-keyword">class</span><span> </span><span id="Comonoid%27"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Comonoid%27"><span class="hs-identifier hs-var">Comonoid'</span></a></span></span><span> </span><span id="local-6989586621679091038"><span class="annot"><a href="#local-6989586621679091038"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>  </span><span id="split%27"><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#split%27"><span class="hs-identifier hs-type">split'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679091038"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span id="local-6989586621679091043"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Comonoid"><span class="hs-identifier hs-type">Comonoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679091043"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679090870"><span class="annot"><span class="annottext">split :: NonEmpty a -&gt; (NonEmpty a, Maybe (NonEmpty a))
</span><a href="#local-6989586621679090870"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679090869"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090869"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679090867"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679090867"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090869"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; NonEmpty a
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe (NonEmpty a)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679090867"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-116"></span><span>  </span><span>
</span><span id="line-117"></span><span id="local-6989586621679091037"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Comonoid%27"><span class="hs-identifier hs-type">Comonoid'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679091037"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679090859"><span class="annot"><span class="annottext">split' :: NonEmpty a -&gt; NonEmpty (NonEmpty a)
</span><a href="#local-6989586621679090859"><span class="hs-identifier hs-var hs-var hs-var hs-var">split'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; NonEmpty a) -&gt; NonEmpty a -&gt; NonEmpty (NonEmpty a)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; NonEmpty a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Comonoid"><span class="hs-identifier hs-type">Comonoid</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679090850"><span class="annot"><span class="annottext">split :: Word -&gt; (Word, Maybe Word)
</span><a href="#local-6989586621679090850"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Word
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621679090849"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679090849"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Maybe Word
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679090849"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>  </span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Comonoid%27"><span class="hs-identifier hs-type">Comonoid'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679090842"><span class="annot"><span class="annottext">split' :: Word -&gt; NonEmpty Word
</span><a href="#local-6989586621679090842"><span class="hs-identifier hs-var hs-var hs-var hs-var">split'</span></a></span></span><span> </span><span id="local-6989586621679090841"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679090841"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; [Word] -&gt; NonEmpty Word
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; [Word]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679090841"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621679091028"><span id="local-6989586621679091029"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Comonoid"><span class="hs-identifier hs-type">Comonoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#CoHeap"><span class="hs-identifier hs-type">CoHeap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091029"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091028"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679090836"><span class="annot"><span class="annottext">split :: CoHeap w a -&gt; (CoHeap w a, Maybe (CoHeap w a))
</span><a href="#local-6989586621679090836"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span id="local-6989586621679090835"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090835"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679090834"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090834"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679090833"><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090833"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
forall w a. w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-var">Root</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090835"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090834"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[CoHeap w a] -&gt; Maybe (CoHeap w a)
forall {w} {a}. [CoHeap w a] -&gt; Maybe (CoHeap w a)
</span><a href="#local-6989586621679090832"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090833"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>      </span><span id="local-6989586621679090832"><span class="annot"><span class="annottext">go :: [CoHeap w a] -&gt; Maybe (CoHeap w a)
</span><a href="#local-6989586621679090832"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CoHeap w a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><a href="#local-6989586621679090832"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span id="local-6989586621679090831"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090831"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679090830"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090830"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679090829"><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090829"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679090828"><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090828"><span class="hs-identifier hs-var">xss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoHeap w a -&gt; Maybe (CoHeap w a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
forall w a. w -&gt; a -&gt; [CoHeap w a] -&gt; CoHeap w a
</span><a href="MonusWeightedSearch.Examples.Categorical.html#Root"><span class="hs-identifier hs-var">Root</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679090831"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679090830"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090829"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[CoHeap w a] -&gt; [CoHeap w a] -&gt; [CoHeap w a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[CoHeap w a]
</span><a href="#local-6989586621679090828"><span class="hs-identifier hs-var">xss</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-133"></span><span>  </span><span>
</span><span id="line-134"></span><span class="hs-comment">-- instance Comonoid' (CoHeap w a) where</span><span>
</span><span id="line-135"></span><span class="hs-comment">--   split' (Root w x xs) = Root w x [] :| xs</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- -- instance Comonoid [a] where</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- --   split (x1:x2:xs) = ([x1], Just (x2:xs))</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- --   split xs = (xs, Nothing)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- law :: (Comonoid' a, Eq a) =&gt; a -&gt; Either Bool ()</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- law xs = either id (const False) $ do</span><span>
</span><span id="line-143"></span><span class="hs-comment">--     (y1,y2:| ys) &lt;- split'' xs</span><span>
</span><span id="line-144"></span><span>    </span><span>
</span><span id="line-145"></span><span>    </span><span>
</span><span id="line-146"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-147"></span><span class="hs-comment">--     split'' x = case split' x of</span><span>
</span><span id="line-148"></span><span class="hs-comment">--       (y :| []) -&gt; Left (x == y)</span><span>
</span><span id="line-149"></span><span class="hs-comment">--       (y1 :| y2 : ys) -&gt; Right (y1, y2 :| ys)</span><span>
</span><span id="line-150"></span><span>  </span><span>
</span><span id="line-151"></span></pre></body></html>