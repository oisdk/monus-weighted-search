<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>MonusWeightedSearch.Examples.Dijkstra</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">monus-weighted-search-0.1.0.0: Efficient search weighted by an ordered monoid with monus.</span><ul class="links" id="page-menu"><li><a href="src/MonusWeightedSearch.Examples.Dijkstra.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Donnacha Ois&#237;n Kidney 2021</td></tr><tr><th>Maintainer</th><td>mail@doisinkidney.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>non-portable</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">MonusWeightedSearch.Examples.Dijkstra</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>An implementation of Dijkstra's algorithm, using the <code><a href="Control-Monad-Heap.html#t:HeapT" title="Control.Monad.Heap">HeapT</a></code> monad.</p><p>This is taken from section 6.1.3 of the paper</p><ul><li>Donnacha Ois&#237;n Kidney and Nicolas Wu. 2021. <em>Algebras for weighted search</em>.
   Proc. ACM Program. Lang. 5, ICFP, Article 72 (August 2021), 30 pages.
   DOI:<a href="https://doi.org/10.1145/3473577">https://doi.org/10.1145/3473577</a></li></ul><p>This is a pretty simple implementation of the algorithm, defined monadically,
 but it retains the time complexity of a standard purely functional
 implementation.</p><p>We use the state monad here to avoid searching from the same node more than
 once (which would lead to an infinite loop). Different algorithms use
 different permutations of the monad transformers: for Dijkstra's algorithm,
 we use <code><code><a href="Control-Monad-Heap.html#t:HeapT" title="Control.Monad.Heap">HeapT</a></code> w (<code><a href="https://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-State-Strict.html#t:State" title="Control.Monad.State.Strict">State</a></code> (<code><a href="https://hackage.haskell.org/package/containers-0.6.4.1/docs/Data-Set.html#t:Set" title="Data.Set">Set</a></code> a)) a</code>, i.e. the <code><a href="Control-Monad-Heap.html#t:HeapT" title="Control.Monad.Heap">HeapT</a></code> is outside of the
 <code><a href="https://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-State-Strict.html#t:State" title="Control.Monad.State.Strict">State</a></code>. This means that each branch of the search proceeds with a different
 state; if we switch the order (to <code><code><a href="https://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-State-Strict.html#t:StateT" title="Control.Monad.State.Strict">StateT</a></code> s (<code><a href="Control-Monad-Heap.html#t:Heap" title="Control.Monad.Heap">Heap</a></code> w) a</code>, for example), we
 get &quot;global&quot; state, which has the semantics of a <em>parser</em>. For an example
 of that, see the module <a href="MonusWeightedSearch-Examples-Parsing.html">MonusWeightedSearch.Examples.Parsing</a>, where the
 heap is used to implement a probabilistic parser.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:graph">graph</a> :: <a href="Data-Monus-Dist.html#t:Graph" title="Data.Monus.Dist">Graph</a> <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:unique">unique</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a =&gt; a -&gt; <a href="Control-Monad-Heap.html#t:HeapT" title="Control.Monad.Heap">HeapT</a> w (<a href="https://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-State-Strict.html#t:State" title="Control.Monad.State.Strict">State</a> (<a href="https://hackage.haskell.org/package/containers-0.6.4.1/docs/Data-Set.html#t:Set" title="Data.Set">Set</a> a)) a</li><li class="src short"><a href="#v:star">star</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; (a -&gt; m a) -&gt; a -&gt; m a</li><li class="src short"><a href="#v:pathed">pathed</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; (a -&gt; m a) -&gt; a -&gt; m (<a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> a)</li><li class="src short"><a href="#v:dijkstra">dijkstra</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a =&gt; <a href="Data-Monus-Dist.html#t:Graph" title="Data.Monus.Dist">Graph</a> a -&gt; a -&gt; [(a, <a href="Data-Monus-Dist.html#t:Dist" title="Data.Monus.Dist">Dist</a>)]</li><li class="src short"><a href="#v:shortestPaths">shortestPaths</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a =&gt; <a href="Data-Monus-Dist.html#t:Graph" title="Data.Monus.Dist">Graph</a> a -&gt; a -&gt; [(<a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> a, <a href="Data-Monus-Dist.html#t:Dist" title="Data.Monus.Dist">Dist</a>)]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="doc"><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import Prelude hiding (head)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import Data.List.NonEmpty (head)
</code></strong></pre></div><div class="top"><p class="src"><a id="v:graph" class="def">graph</a> :: <a href="Data-Monus-Dist.html#t:Graph" title="Data.Monus.Dist">Graph</a> <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/MonusWeightedSearch.Examples.Dijkstra.html#graph" class="link">Source</a> <a href="#v:graph" class="selflink">#</a></p><div class="doc"><p>The example graph from
 <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm">the Wikipedia article on Dijkstra's algorithm</a>.</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/5/57/Dijkstra_Animation.gif" /></p></div></div><div class="top"><p class="src"><a id="v:unique" class="def">unique</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a =&gt; a -&gt; <a href="Control-Monad-Heap.html#t:HeapT" title="Control.Monad.Heap">HeapT</a> w (<a href="https://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-State-Strict.html#t:State" title="Control.Monad.State.Strict">State</a> (<a href="https://hackage.haskell.org/package/containers-0.6.4.1/docs/Data-Set.html#t:Set" title="Data.Set">Set</a> a)) a <a href="src/MonusWeightedSearch.Examples.Dijkstra.html#unique" class="link">Source</a> <a href="#v:unique" class="selflink">#</a></p><div class="doc"><p><code><code><a href="MonusWeightedSearch-Examples-Dijkstra.html#v:unique" title="MonusWeightedSearch.Examples.Dijkstra">unique</a></code> x</code> checks that <code>x</code> has not yet been seen in this branch of the
 computation.</p></div></div><div class="top"><p class="src"><a id="v:star" class="def">star</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; (a -&gt; m a) -&gt; a -&gt; m a <a href="src/MonusWeightedSearch.Examples.Dijkstra.html#star" class="link">Source</a> <a href="#v:star" class="selflink">#</a></p><div class="doc"><p>This is the Kleene star on the semiring of <code><a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a></code>. It is analagous to
 the <code><a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Applicative.html#v:many" title="Control.Applicative">many</a></code> function on <code><a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Applicative.html#t:Alternative" title="Control.Applicative">Alternative</a></code>s.</p></div></div><div class="top"><p class="src"><a id="v:pathed" class="def">pathed</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; (a -&gt; m a) -&gt; a -&gt; m (<a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> a) <a href="src/MonusWeightedSearch.Examples.Dijkstra.html#pathed" class="link">Source</a> <a href="#v:pathed" class="selflink">#</a></p><div class="doc"><p>This is a version of <code><a href="MonusWeightedSearch-Examples-Dijkstra.html#v:star" title="MonusWeightedSearch.Examples.Dijkstra">star</a></code> which keeps track of the inputs it was given.</p></div></div><div class="top"><p class="src"><a id="v:dijkstra" class="def">dijkstra</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a =&gt; <a href="Data-Monus-Dist.html#t:Graph" title="Data.Monus.Dist">Graph</a> a -&gt; a -&gt; [(a, <a href="Data-Monus-Dist.html#t:Dist" title="Data.Monus.Dist">Dist</a>)] <a href="src/MonusWeightedSearch.Examples.Dijkstra.html#dijkstra" class="link">Source</a> <a href="#v:dijkstra" class="selflink">#</a></p><div class="doc"><p>Dijkstra's algorithm. This function returns the length of the shortest path
 from a given vertex to every vertex in the graph.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>dijkstra graph 1
</code></strong>[(1,0),(2,7),(3,9),(6,11),(5,20),(4,20)]
</pre><p>A version which actually produces the paths is <code><a href="MonusWeightedSearch-Examples-Dijkstra.html#v:shortestPaths" title="MonusWeightedSearch.Examples.Dijkstra">shortestPaths</a></code></p></div></div><div class="top"><p class="src"><a id="v:shortestPaths" class="def">shortestPaths</a> :: <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a =&gt; <a href="Data-Monus-Dist.html#t:Graph" title="Data.Monus.Dist">Graph</a> a -&gt; a -&gt; [(<a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> a, <a href="Data-Monus-Dist.html#t:Dist" title="Data.Monus.Dist">Dist</a>)] <a href="src/MonusWeightedSearch.Examples.Dijkstra.html#shortestPaths" class="link">Source</a> <a href="#v:shortestPaths" class="selflink">#</a></p><div class="doc"><p>Dijkstra's algorithm, which produces a path.</p><p>The only difference between this function and <code><a href="MonusWeightedSearch-Examples-Dijkstra.html#v:shortestPaths" title="MonusWeightedSearch.Examples.Dijkstra">shortestPaths</a></code> is that this
 uses <code><a href="MonusWeightedSearch-Examples-Dijkstra.html#v:pathed" title="MonusWeightedSearch.Examples.Dijkstra">pathed</a></code> rather than <code><a href="MonusWeightedSearch-Examples-Dijkstra.html#v:star" title="MonusWeightedSearch.Examples.Dijkstra">star</a></code>.</p><p>The following finds the shortest path from vertex 1 to 5:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>filter ((5==) . head . fst) (shortestPaths graph 1)
</code></strong>[(5 :| [6,3,1],20)]
</pre><p>And it is indeed <code>[1,3,6,5]</code>. (it's returned in reverse)</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>